SBATCH_INFO: Printing diagnostics (visible devices and nvidia-smi)...
0
Fri Apr 11 12:59:02 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 555.42.02              Driver Version: 555.42.02      CUDA Version: 12.5     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100 80GB PCIe          Off |   00000000:98:00.0 Off |                    0 |
| N/A   54C    P0             77W /  300W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
SBATCH_INFO: Running character recognition training...
model         : rnn_base
batch_size    : 64
epochs        : 15
learning_rate : 0.001
val_split     : 0.2
use_colour    : False
image_size    : [200, 50]
train_path    : dataset/train
test_path     : dataset/test
========== TRAIN.PY START ==========
Using device: cuda
Loading data loaders...
Initializing rnn_base model...
Begin training...
Epoch 1/15 | Batch 0/101 | Loss: 26.6149
Epoch [1/15], Avg Loss: 4.8763, Avg Val Loss: 3.9264
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 2/15 | Batch 0/101 | Loss: 3.9126
Epoch [2/15], Avg Loss: 3.9296, Avg Val Loss: 3.9298
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 3/15 | Batch 0/101 | Loss: 3.9130
Epoch [3/15], Avg Loss: 3.9304, Avg Val Loss: 3.9269
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 4/15 | Batch 0/101 | Loss: 3.9198
Epoch [4/15], Avg Loss: 3.9238, Avg Val Loss: 3.9171
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 5/15 | Batch 0/101 | Loss: 3.9311
Epoch [5/15], Avg Loss: 3.9098, Avg Val Loss: 3.9122
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 6/15 | Batch 0/101 | Loss: 3.8872
Epoch [6/15], Avg Loss: 3.9020, Avg Val Loss: 3.8970
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 7/15 | Batch 0/101 | Loss: 3.8941
Epoch [7/15], Avg Loss: 3.8941, Avg Val Loss: 3.9022
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 8/15 | Batch 0/101 | Loss: 3.8931
Epoch [8/15], Avg Loss: 3.8842, Avg Val Loss: 3.8758
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 9/15 | Batch 0/101 | Loss: 3.8835
Epoch [9/15], Avg Loss: 3.8644, Avg Val Loss: 3.8663
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 10/15 | Batch 0/101 | Loss: 3.8825
Epoch [10/15], Avg Loss: 3.8207, Avg Val Loss: 3.7747
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 11/15 | Batch 0/101 | Loss: 3.7723
Epoch [11/15], Avg Loss: 3.7107, Avg Val Loss: 3.5875
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 12/15 | Batch 0/101 | Loss: 3.5978
Epoch [12/15], Avg Loss: 3.4769, Avg Val Loss: 3.4186
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 13/15 | Batch 0/101 | Loss: 3.4539
Epoch [13/15], Avg Loss: 2.9669, Avg Val Loss: 2.7380
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 14/15 | Batch 0/101 | Loss: 2.7162
Epoch [14/15], Avg Loss: 2.4912, Avg Val Loss: 2.3147
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Epoch 15/15 | Batch 0/101 | Loss: 2.2710
Epoch [15/15], Avg Loss: 2.1262, Avg Val Loss: 2.0067
Checkpoint saved at trained_models/rnn_base_checkpoint.pt
Training complete!
Model saved to trained_models/rnn_base.pt
Saved learning curve as learning_curves/rnn_base.png
Checkpoint deleted after successful training.
SBATCH_INFO: Running character recognition evaluation...
========== EVALUATE.PY START ==========
Model loaded successfully from 'trained_models/rnn_base.pt'
Loading test dataset...
Evaluating model...
Batch 0 | Word Acc: 0.00% | Char Acc: 20.00%
Batch 50 | Word Acc: 5.88% | Char Acc: 45.98%
Batch 100 | Word Acc: 5.94% | Char Acc: 43.87%
Batch 150 | Word Acc: 6.62% | Char Acc: 42.44%
Batch 200 | Word Acc: 6.97% | Char Acc: 42.72%
Batch 250 | Word Acc: 7.17% | Char Acc: 42.33%
Batch 300 | Word Acc: 7.31% | Char Acc: 43.12%
Batch 350 | Word Acc: 7.12% | Char Acc: 42.91%
Batch 400 | Word Acc: 6.48% | Char Acc: 42.16%
Batch 450 | Word Acc: 6.65% | Char Acc: 41.95%
Batch 500 | Word Acc: 6.59% | Char Acc: 41.96%
Batch 550 | Word Acc: 5.99% | Char Acc: 42.40%
Batch 600 | Word Acc: 5.99% | Char Acc: 42.44%
Batch 650 | Word Acc: 6.45% | Char Acc: 41.80%
Batch 700 | Word Acc: 6.13% | Char Acc: 41.50%
Batch 750 | Word Acc: 5.86% | Char Acc: 41.08%
Batch 800 | Word Acc: 5.62% | Char Acc: 40.67%
Batch 850 | Word Acc: 5.88% | Char Acc: 40.71%
Batch 900 | Word Acc: 5.55% | Char Acc: 40.45%
Batch 950 | Word Acc: 5.47% | Char Acc: 40.42%
Batch 1000 | Word Acc: 5.39% | Char Acc: 40.26%
Batch 1050 | Word Acc: 5.52% | Char Acc: 40.52%
Batch 1100 | Word Acc: 5.72% | Char Acc: 40.75%
Batch 1150 | Word Acc: 5.65% | Char Acc: 41.13%
Batch 1200 | Word Acc: 5.50% | Char Acc: 40.91%
Batch 1250 | Word Acc: 5.44% | Char Acc: 41.02%
Batch 1300 | Word Acc: 5.23% | Char Acc: 40.77%
Batch 1350 | Word Acc: 5.11% | Char Acc: 40.57%
Batch 1400 | Word Acc: 5.00% | Char Acc: 40.67%
Batch 1450 | Word Acc: 5.10% | Char Acc: 40.71%
Batch 1500 | Word Acc: 5.06% | Char Acc: 40.82%
Batch 1550 | Word Acc: 4.96% | Char Acc: 40.83%
Batch 1600 | Word Acc: 5.00% | Char Acc: 40.86%
Batch 1650 | Word Acc: 4.91% | Char Acc: 40.70%
Batch 1700 | Word Acc: 5.06% | Char Acc: 40.65%
Batch 1750 | Word Acc: 5.20% | Char Acc: 40.84%
Batch 1800 | Word Acc: 5.11% | Char Acc: 41.03%
Batch 1850 | Word Acc: 5.08% | Char Acc: 41.01%
Batch 1900 | Word Acc: 4.94% | Char Acc: 41.11%
Batch 1950 | Word Acc: 4.87% | Char Acc: 41.03%
Word Accuracy: 4.95%
Character Accuracy: 41.09%
Character-level Macro Precision: 44.22%
Character-level Macro Recall: 43.79%
Character-level Macro F1 Score: 42.75%
